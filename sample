# print percentage of missing values in the categorical variables in training set
 
X_train[categorical].isnull().mean()
 
# checking nan values in the dataframe df
df[categorical].isnull().sum()
 
 
# impute missing categorical variables with most frequent value
 
for df2 in [X_train, X_test]:
    df2['WindGustDir'].fillna(X_train['WindGustDir'].mode()[0], inplace=True)
    df2['WindDir9am'].fillna(X_train['WindDir9am'].mode()[0], inplace=True)
    df2['WindDir3pm'].fillna(X_train['WindDir3pm'].mode()[0], inplace=True)
    df2['RainToday'].fillna(X_train['RainToday'].mode()[0], inplace=True)
 
 
# check missing values in categorical variables in X_train
 
X_train[categorical].isnull().sum()
 
